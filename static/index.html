<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="js/layui/css/layui.css" media="all">
</head>
<body>
    <div class="layui-form-item" class="layui-row">
        <div class="layui-col-xs3">
            <label class="layui-form-label">key</label>
            <div class="layui-input-block">
                <input id="key" type="search" value="红" class="layui-input">
            </div>
        </div>
        <div class="layui-col-xs3">
            <label class="layui-form-label">period</label>
            <div class="layui-input-block">
                <input id="period" type="input" value="D" class="layui-input">
            </div>
        </div>
        <div class="layui-col-xs3">
            <label class="layui-form-label">option</label>
            <div class="layui-input-block">
                <input id="option" type="input" value="" class="layui-input">
            </div>
        </div>
        <div class="layui-col-xs3">
            <label class="layui-form-label">来源</label>
            <div class="layui-input-block">
                <input type="checkbox" name="website" value="HypebeastItem" title="Hypebeast" checked>Hypebeast
                <input type="checkbox" name="website" value="ISizeNewsItem" title="ISize">ISize

                <button onclick="f1()" class="layui-btn">搜索</button>
            </div>
        </div>
    </div>

<div id="container" style="height:100%">container</div>
<script type="text/javascript" src="js/echarts.js"></script>
<script type="text/javascript" src="js/jquery-3.3.1.js"></script>
<script type="text/javascript" src="js/layui/layui.all.js"></script>
<script type="text/javascript">

    function f1() {
        var dom = document.getElementById("container");
        var sub = document.createElement('div');
        sub.setAttribute('style', 'height:500px');
        dom.appendChild(sub);
        var myChart = echarts.init(sub);
        var app = {};
        var key = $('#key')[0].value;
        var period = $('#period')[0].value;
        var option = $('#option')[0].value;
        var website = [];
        $('input[name="website"]:checked').each(function (i) {
            website[i] = $(this).val();
        });
        console.log('website');
        console.log(website);
        var url = '/info/get';
        $.get({
            url: url,
            dataType: 'json',
            type: 'post',
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                console.log("请求失败！");
            },
            data: {'key': key, 'period': period, 'website': JSON.stringify(website), 'option': option},
            async: true,
            success: function (data, textStatus, jqXHR) {
                console.log('成功');
                console.log(data);
                console.log(textStatus);
                console.log(jqXHR);

                myChart.setOption(option = {
                        title: {
                            text: key + "-" + period
                        },
                        xAxis: {
                            data: data['index']
                        },
                        yAxis: {
                            type: 'value'
                        },
                        series: {
                            type: 'line',
                            data: data['data']
                        }
                    }
                )
            }
        })
    }
</script>
</body>
</html>